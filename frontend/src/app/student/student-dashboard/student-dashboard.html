<div class="page-wrap">

  <!-- HEADER -->
  <header class="topbar">
    <h1 class="greeting">HELLO, {{ userName().toUpperCase() }}!</h1>
    <div class="search-wrapper">
      <input class="search-input" type="search" placeholder="Search"/>
      <svg class="search-icon" viewBox="0 0 24 24">
        <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </div>
  </header>

  <main class="main-grid">

    <!-- LEFT GRID -->
    <section class="left-grid">

      <!-- TEACHERS -->
      <div class="card card-teachers">
        <h2>Linked Teachers</h2>

        <div *ngFor="let t of teachers()" class="teacher-item">
          <div class="teacher-left">
            <img [src]="t.avatarUrl" [alt]="t.fullName" class="teacher-avatar"/>
            <div class="teacher-meta">
              <div class="t-name">{{ t.fullName }}</div>
              <div class="t-role">{{ t.role }}</div>
            </div>
          </div>

          <!-- Buton pentru vizualizare profil -->
          <a class="see-more view-profile-link" (click)="openTeacherModal(t)">
            View Profile &gt;
          </a>
        </div>

        <a class="see-more" href="#">See more ></a>
      </div>

      <!-- EVENTS -->
      <div class="card card-events">
        <h2>Upcoming events</h2>
        <div *ngFor="let e of events()" class="event-item">
          <img [src]="e.imageUrl" [alt]="e.title" class="event-image"/>
          <div class="event-meta">
            <div class="e-title">{{ e.title }}</div>
            <div class="e-sub"><span>{{ e.date }}</span> · <strong>{{ e.time }}</strong></div>
          </div>
        </div>
        <a class="see-more" href="#">See more &gt;</a>
      </div>

      <!-- CALENDAR & SCHEDULE -->
      <div class="card card-schedule lavender">
        <h2>My schedule</h2>
        <div class="schedule-inner">

          <!-- Calendar -->
          <div class="calendar-box">
            <div class="calendar-header">
              <button class="cal-nav" (click)="prevMonth()">&lt;</button>
              <div class="month">{{ monthName() }}</div>
              <button class="cal-nav" (click)="nextMonth()">&gt;</button>
            </div>

            <div class="calendar-grid-week">
              <div *ngFor="let wd of weekdays">{{ wd }}</div>
            </div>

            <div class="calendar-grid-days">
              <div *ngFor="let d of days"
                   class="calendar-day"
                   [class.empty]="d === 0"
                   [class.selected]="d === selectedDay() || dayHasLesson(d)"
                   (click)="selectDay(d)">
                {{ d !== 0 ? d : '' }}
              </div>
            </div>
          </div>

          <!-- Schedule list -->
          <div class="schedule-list">
            <h3>Lecții pentru {{ selectedDay() || dailyLessons()[0]?.day }}/{{ currentMonth().getMonth() + 1 }}</h3>
            <div *ngFor="let l of lessonsForSelectedDay()" class="schedule-item">
              <div class="schedule-card">
                <div class="lesson-title">{{ l.title }}</div>
                <div class="lesson-time">{{ l.time }} - {{ l.day }}/{{ currentMonth().getMonth() + 1 }}</div>
              </div>
            </div>
            <div *ngIf="lessonsForSelectedDay().length === 0">Nu există lecții pentru această zi.</div>
          </div>

        </div>
      </div>

    </section>

    <!-- RIGHT COLUMN -->
    <aside class="right-column">
      <div class="card card-purple">
        <h2>Attendance</h2>
        <div class="gauge-wrap">
          <div class="gauge-container" [ngStyle]="{ 'background': gaugeStyle(attendance(), '#FF6B9A') }">
            <span>{{ attendance() }}%</span>
            <div class="gauge-inner-circle"></div>
          </div>
        </div>
      </div>
      <div class="card card-purple">
        <h2>Homework</h2>
        <div class="gauge-wrap">
          <div class="gauge-container" [ngStyle]="{ 'background': gaugeStyle(homework(), '#68E0C6') }">
            <span>{{ homework() }}%</span>
            <div class="gauge-inner-circle"></div>
          </div>
        </div>
      </div>
      <div class="card card-purple">
        <h2>Rating</h2>
        <div class="gauge-wrap">
          <div class="gauge-container" [ngStyle]="{ 'background': gaugeStyle(rating(), '#FFD36B') }">
            <span>{{ rating() }}%</span>
            <div class="gauge-inner-circle"></div>
          </div>
        </div>
        <a class="see-more white" href="#">See more &gt;</a>
      </div>
    </aside>

  </main>

  <!-- MODAL TEACHER PROFILE -->
  <div class="modal-backdrop" *ngIf="isModalOpen()">
  <div class="modal">
    <button class="close-btn" (click)="closeTeacherModal()">X</button>
    <img *ngIf="selectedTeacher()?.avatarUrl" [src]="selectedTeacher()?.avatarUrl" alt="{{selectedTeacher()?.fullName}}" class="modal-avatar"/>
    <h3>{{ selectedTeacher()?.fullName }}</h3>
    <p><strong>Email:</strong> {{ selectedTeacher()?.email }}</p>
    <p><strong>Rol:</strong> {{ selectedTeacher()?.role }}</p>
    <p *ngIf="selectedTeacher()?.phone"><strong>Phone:</strong> {{ selectedTeacher()?.phone }}</p>
    <p *ngIf="selectedTeacher()?.course"><strong>Curs:</strong> {{ selectedTeacher()?.course }}</p>
  </div>
</div>


</div>
